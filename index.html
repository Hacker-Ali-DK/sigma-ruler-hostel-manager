<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Σ-Ruler Hostel Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-blue: #1e3a8a;
            --dark-blue: #1e40af;
            --light-blue: #3b82f6;
            --accent-blue: #60a5fa;
            --background: #f8fafc;
            --surface: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--background);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            color: white;
            padding: 25px 0;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-lg);
        }

        .header-content {
            text-align: center;
            padding: 0 20px;
        }

        .logo {
            font-size: 2.5rem;
            margin-bottom: 8px;
            font-weight: 800;
        }

        header h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        header p {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Dashboard Grid */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: var(--surface);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }

        .dashboard-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
            border-color: var(--light-blue);
        }

        .card-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
            color: var(--primary-blue);
        }

        .dashboard-card h2 {
            margin-bottom: 8px;
            color: var(--primary-blue);
            font-size: 1.3rem;
        }

        .dashboard-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Module Sections */
        .module {
            display: none;
            background: var(--surface);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .module.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .module-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-blue);
        }

        .module-header h2 {
            color: var(--primary-blue);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .back-btn {
            background: var(--light-blue);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            font-size: 0.9rem;
        }

        .back-btn:hover {
            background: var(--dark-blue);
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .tab-btn {
            background: var(--surface);
            border: 1px solid var(--border);
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            flex: 1;
            min-width: 110px;
            text-align: center;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        .tab-btn.active {
            background: var(--light-blue);
            color: white;
            border-color: var(--light-blue);
        }

        .tab-btn:hover:not(.active) {
            border-color: var(--light-blue);
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
            background: var(--surface);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--light-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .btn {
            background: var(--light-blue);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background 0.3s;
        }

        .btn:hover {
            background: var(--dark-blue);
        }

        /* Enhanced Table Styles */
        .data-section {
            margin-top: 25px;
        }

        .section-title {
            margin-bottom: 15px;
            color: var(--primary-blue);
            font-size: 1.3rem;
        }

        .table-container {
            background: var(--surface);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            min-width: 600px;
        }

        .data-table th {
            background: var(--primary-blue);
            color: white;
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .data-table td {
            padding: 10px;
            border-bottom: 1px solid var(--border);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover {
            background: #f8fafc;
        }

        .amount-positive {
            color: var(--success);
            font-weight: 600;
        }

        .amount-negative {
            color: var(--danger);
            font-weight: 600;
        }

        .table-actions {
            display: flex;
            gap: 6px;
            justify-content: center;
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .delete-btn {
            color: var(--danger);
        }

        .edit-btn {
            color: var(--warning);
        }

        .action-btn:hover {
            background: #f1f5f9;
            transform: scale(1.1);
        }

        /* Summary Cards */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .summary-card {
            background: var(--surface);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .summary-card h3 {
            margin-bottom: 12px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .summary-amount {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .income-amount {
            color: var(--success);
        }

        .expense-amount {
            color: var(--danger);
        }

        .balance-amount {
            color: var(--light-blue);
        }

        /* Schedule Styles */
        .schedule-grid {
            display: grid;
            gap: 15px;
        }

        .day-schedule {
            background: var(--surface);
            border-radius: 12px;
            padding: 15px;
            box-shadow: var(--shadow);
        }

        .day-header {
            background: var(--light-blue);
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .schedule-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid var(--border);
        }

        .schedule-item:last-child {
            border-bottom: none;
        }

        .schedule-time {
            font-weight: 600;
            color: var(--primary-blue);
            min-width: 70px;
        }

        /* Edit Modal */
        .edit-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .edit-modal.active {
            display: flex;
        }

        .edit-content {
            background: var(--surface);
            border-radius: 15px;
            padding: 25px;
            width: 90%;
            max-width: 500px;
            box-shadow: var(--shadow-lg);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .edit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .edit-header h2 {
            color: var(--text-primary);
        }

        /* Notification System */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            max-width: 350px;
        }

        .notification {
            background: var(--surface);
            border-left: 4px solid var(--light-blue);
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInRight 0.3s ease;
        }

        .notification.warning {
            border-left-color: var(--warning);
        }

        .notification.danger {
            border-left-color: var(--danger);
        }

        .notification.success {
            border-left-color: var(--success);
        }

        .notification-icon {
            font-size: 1.3rem;
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 3px;
            font-size: 0.9rem;
        }

        .notification-message {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .notification-close {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .summary-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .nav-tabs {
                flex-direction: row;
            }
            
            .module-header {
                flex-direction: column;
                gap: 12px;
                align-items: flex-start;
            }
            
            .data-table {
                font-size: 12px;
            }
            
            .data-table th,
            .data-table td {
                padding: 8px 6px;
            }

            .header-content {
                text-align: center;
            }

            .logo {
                font-size: 2rem;
            }

            header h1 {
                font-size: 1.5rem;
            }

            header p {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .module {
                padding: 15px;
            }
            
            .dashboard-card {
                padding: 20px;
            }
            
            .table-actions {
                flex-direction: column;
                gap: 4px;
            }

            .notification-container {
                right: 10px;
                left: 10px;
                max-width: none;
            }
        }

        /* Utility Classes */
        .hidden {
            display: none;
        }

        .text-center {
            text-align: center;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .badge {
            display: inline-block;
            padding: 3px 6px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .badge-success {
            background: var(--success);
            color: white;
        }

        .badge-warning {
            background: var(--warning);
            color: white;
        }

        .badge-danger {
            background: var(--danger);
            color: white;
        }
    </style>
</head>
<body>
    <!-- Edit Modal -->
    <div class="edit-modal" id="editModal">
        <div class="edit-content">
            <div class="edit-header">
                <h2 id="editModalTitle">Edit Item</h2>
                <button class="close-modal" id="closeEditModal">&times;</button>
            </div>
            <form id="editForm">
                <!-- Form content will be dynamically populated -->
            </form>
        </div>
    </div>

    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <div class="container">
        <!-- Welcome Dashboard -->
        <header>
            <div class="header-content">
                <div class="logo">Σ_R</div>
                <h1>Hello, Sigma-Ruler!</h1>
                <p>Your Professional Hostel Management System</p>
            </div>
        </header>

        <!-- Main Dashboard -->
        <div class="dashboard" id="main-dashboard">
            <div class="dashboard-card" data-module="finance">
                <div class="card-icon">
                    <i class="fas fa-money-bill-wave"></i>
                </div>
                <h2>Finance Manager</h2>
                <p>Track pocket money, expenses, and loans</p>
            </div>

            <div class="dashboard-card" data-module="food">
                <div class="card-icon">
                    <i class="fas fa-utensils"></i>
                </div>
                <h2>Food Menu</h2>
                <p>Hostel cafe menu with prices</p>
            </div>

            <div class="dashboard-card" data-module="study">
                <div class="card-icon">
                    <i class="fas fa-book"></i>
                </div>
                <h2>Study Schedule</h2>
                <p>Classes, assignments, and exams</p>
            </div>
        </div>

        <!-- Finance Module -->
        <div class="module" id="finance-module">
            <div class="module-header">
                <h2><i class="fas fa-money-bill-wave"></i> Finance Manager</h2>
                <button class="back-btn">Back to Dashboard</button>
            </div>

            <!-- Finance Navigation -->
            <div class="nav-tabs">
                <button class="tab-btn active" data-tab="pocket-money">Pocket Money</button>
                <button class="tab-btn" data-tab="expenses">Expenses</button>
                <button class="tab-btn" data-tab="loans">Loans</button>
                <button class="tab-btn" data-tab="summary">Summary</button>
            </div>

            <!-- Pocket Money Section -->
            <div class="tab-content active" id="pocket-money-tab">
                <h3 class="section-title">Add Pocket Money</h3>
                <form id="pocket-money-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="pocket-amount">Amount (Rs.)</label>
                            <input type="number" id="pocket-amount" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="pocket-date">Date Received</label>
                            <input type="date" id="pocket-date" required>
                        </div>
                        <div class="form-group">
                            <label for="pocket-source">Source</label>
                            <input type="text" id="pocket-source" placeholder="e.g., Parents, Part-time job" required>
                        </div>
                    </div>
                    <button type="submit" class="btn">Add Pocket Money</button>
                </form>

                <div class="data-section">
                    <h3 class="section-title">Pocket Money History</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Source</th>
                                    <th>Amount</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="pocket-money-table">
                                <!-- Table rows will be added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Expenses Section -->
            <div class="tab-content hidden" id="expenses-tab">
                <h3 class="section-title">Add Expense</h3>
                <form id="expense-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="expense-amount">Amount (Rs.)</label>
                            <input type="number" id="expense-amount" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="expense-date">Date</label>
                            <input type="date" id="expense-date" required>
                        </div>
                        <div class="form-group">
                            <label for="expense-category">Category</label>
                            <select id="expense-category" required>
                                <option value="food">Food</option>
                                <option value="transport">Transport</option>
                                <option value="entertainment">Entertainment</option>
                                <option value="bills">Bills</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="expense-description">Description</label>
                            <input type="text" id="expense-description" placeholder="What did you spend on?" required>
                        </div>
                    </div>
                    <button type="submit" class="btn">Add Expense</button>
                </form>

                <div class="data-section">
                    <h3 class="section-title">Expense History</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Category</th>
                                    <th>Amount</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="expenses-table">
                                <!-- Table rows will be added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Loans Section -->
            <div class="tab-content hidden" id="loans-tab">
                <h3 class="section-title">Add Loan</h3>
                <form id="loan-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="loan-amount">Amount (Rs.)</label>
                            <input type="number" id="loan-amount" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="loan-type">Type</label>
                            <select id="loan-type" required>
                                <option value="given">Given to Someone</option>
                                <option value="taken">Taken from Someone</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="loan-person">Person</label>
                            <input type="text" id="loan-person" placeholder="Person's name" required>
                        </div>
                        <div class="form-group">
                            <label for="loan-date">Date</label>
                            <input type="date" id="loan-date" required>
                        </div>
                        <div class="form-group">
                            <label for="return-date">Return Date</label>
                            <input type="date" id="return-date" required>
                        </div>
                    </div>
                    <button type="submit" class="btn">Add Loan</button>
                </form>

                <div class="data-section">
                    <h3 class="section-title">Loan History</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Person</th>
                                    <th>Type</th>
                                    <th>Amount</th>
                                    <th>Return Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="loans-table">
                                <!-- Table rows will be added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Finance Summary -->
            <div class="tab-content hidden" id="summary-tab">
                <h3 class="section-title">Financial Summary</h3>
                <div class="summary-cards">
                    <div class="summary-card">
                        <h3>Total Pocket Money</h3>
                        <div class="summary-amount income-amount" id="total-pocket-money">Rs. 0.00</div>
                    </div>
                    <div class="summary-card">
                        <h3>Total Expenses</h3>
                        <div class="summary-amount expense-amount" id="total-expenses">Rs. 0.00</div>
                    </div>
                    <div class="summary-card">
                        <h3>Current Balance</h3>
                        <div class="summary-amount balance-amount" id="current-balance">Rs. 0.00</div>
                    </div>
                    <div class="summary-card">
                        <h3>Active Loans</h3>
                        <div class="summary-amount" id="active-loans">0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Food Module -->
        <div class="module" id="food-module">
            <div class="module-header">
                <h2><i class="fas fa-utensils"></i> Hostel Cafe Menu</h2>
                <button class="back-btn">Back to Dashboard</button>
            </div>

            <div class="data-section">
                <h3 class="section-title">Food Menu</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Item Name</th>
                                <th>Category</th>
                                <th>Price (Rs.)</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="food-menu-table">
                            <!-- Table rows will be added here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="mt-20">
                <h3 class="section-title">Add New Food Item</h3>
                <form id="food-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="food-name">Food Name</label>
                            <input type="text" id="food-name" placeholder="e.g., Chicken Biryani" required>
                        </div>
                        <div class="form-group">
                            <label for="food-price">Price (Rs.)</label>
                            <input type="number" id="food-price" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="food-category">Category</label>
                            <select id="food-category" required>
                                <option value="breakfast">Breakfast</option>
                                <option value="lunch">Lunch</option>
                                <option value="dinner">Dinner</option>
                                <option value="snacks">Snacks</option>
                                <option value="drinks">Drinks</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn">Add Food Item</button>
                </form>
            </div>
        </div>

        <!-- Study Module -->
        <div class="module" id="study-module">
            <div class="module-header">
                <h2><i class="fas fa-book"></i> Study Schedule</h2>
                <button class="back-btn">Back to Dashboard</button>
            </div>

            <!-- Study Navigation -->
            <div class="nav-tabs">
                <button class="tab-btn active" data-tab="classes">Classes</button>
                <button class="tab-btn" data-tab="assignments">Assignments</button>
                <button class="tab-btn" data-tab="exams">Exams</button>
            </div>

            <!-- Classes Section -->
            <div class="tab-content active" id="classes-tab">
                <h3 class="section-title">Add Class</h3>
                <form id="class-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="class-name">Class Name</label>
                            <input type="text" id="class-name" placeholder="e.g., Data Structures" required>
                        </div>
                        <div class="form-group">
                            <label for="class-day">Day</label>
                            <select id="class-day" required>
                                <option value="monday">Monday</option>
                                <option value="tuesday">Tuesday</option>
                                <option value="wednesday">Wednesday</option>
                                <option value="thursday">Thursday</option>
                                <option value="friday">Friday</option>
                                <option value="saturday">Saturday</option>
                                <option value="sunday">Sunday</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="class-time">Time</label>
                            <input type="time" id="class-time" required>
                        </div>
                        <div class="form-group">
                            <label for="class-location">Location</label>
                            <input type="text" id="class-location" placeholder="e.g., CS-101" required>
                        </div>
                    </div>
                    <button type="submit" class="btn">Add Class</button>
                </form>

                <div class="data-section">
                    <h3 class="section-title">Class Schedule</h3>
                    <div class="schedule-grid" id="classes-schedule">
                        <!-- Classes will be organized by day -->
                    </div>
                </div>
            </div>

            <!-- Assignments Section -->
            <div class="tab-content hidden" id="assignments-tab">
                <h3 class="section-title">Add Assignment</h3>
                <form id="assignment-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="assignment-title">Title</label>
                            <input type="text" id="assignment-title" placeholder="Assignment title" required>
                        </div>
                        <div class="form-group">
                            <label for="assignment-subject">Subject</label>
                            <input type="text" id="assignment-subject" placeholder="e.g., Computer Science" required>
                        </div>
                        <div class="form-group">
                            <label for="assignment-deadline">Deadline</label>
                            <input type="datetime-local" id="assignment-deadline" required>
                        </div>
                        <div class="form-group">
                            <label for="assignment-topic">Topic/Description</label>
                            <textarea id="assignment-topic" rows="3" placeholder="Brief description of the assignment" required></textarea>
                        </div>
                    </div>
                    <button type="submit" class="btn">Add Assignment</button>
                </form>

                <div class="data-section">
                    <h3 class="section-title">Assignments</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Subject</th>
                                    <th>Deadline</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="assignments-table">
                                <!-- Table rows will be added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Exams Section -->
            <div class="tab-content hidden" id="exams-tab">
                <h3 class="section-title">Add Exam</h3>
                <form id="exam-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="exam-subject">Subject</label>
                            <input type="text" id="exam-subject" placeholder="e.g., Mathematics" required>
                        </div>
                        <div class="form-group">
                            <label for="exam-date">Date & Time</label>
                            <input type="datetime-local" id="exam-date" required>
                        </div>
                        <div class="form-group">
                            <label for="exam-location">Location</label>
                            <input type="text" id="exam-location" placeholder="e.g., Exam Hall A" required>
                        </div>
                        <div class="form-group">
                            <label for="exam-topics">Topics to Study</label>
                            <textarea id="exam-topics" rows="3" placeholder="List important topics" required></textarea>
                        </div>
                    </div>
                    <button type="submit" class="btn">Add Exam</button>
                </form>

                <div class="data-section">
                    <h3 class="section-title">Exams Schedule</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Subject</th>
                                    <th>Date & Time</th>
                                    <th>Location</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="exams-table">
                                <!-- Table rows will be added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data structure
        let appData = {
            profile: {
                name: "Sigma Ruler"
            },
            pocketMoney: [],
            expenses: [],
            loans: [],
            foodMenu: [],
            classes: [],
            assignments: [],
            exams: []
        };

        // Current item being edited
        let currentEditItem = null;
        let currentEditType = null;

        // Enhanced Notification system
        function showNotification(title, message, type = 'info', duration = 5000) {
            const notificationContainer = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-icon">
                    <i class="fas fa-${type === 'warning' ? 'exclamation-triangle' : type === 'danger' ? 'exclamation-circle' : type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <button class="notification-close">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            notificationContainer.appendChild(notification);
            
            // Auto remove after duration
            const timeout = setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideInRight 0.3s ease reverse';
                    setTimeout(() => notification.remove(), 300);
                }
            }, duration);
            
            // Close button
            notification.querySelector('.notification-close').addEventListener('click', () => {
                clearTimeout(timeout);
                notification.style.animation = 'slideInRight 0.3s ease reverse';
                setTimeout(() => notification.remove(), 300);
            });
        }

        // Enhanced notification checker
        function checkNotifications() {
            const now = new Date();
            let hasUpcomingItems = false;
            
            // Check assignments
            appData.assignments.forEach(assignment => {
                const deadline = new Date(assignment.deadline);
                const timeDiff = deadline - now;
                const hoursDiff = timeDiff / (1000 * 60 * 60);
                
                if (hoursDiff > 0 && hoursDiff <= 24) {
                    showNotification(
                        'Assignment Due Soon!',
                        `${assignment.title} is due in ${Math.ceil(hoursDiff)} hours`,
                        'warning',
                        8000
                    );
                    hasUpcomingItems = true;
                }
            });
            
            // Check exams
            appData.exams.forEach(exam => {
                const examDate = new Date(exam.date);
                const timeDiff = examDate - now;
                const daysDiff = timeDiff / (1000 * 60 * 60 * 24);
                
                if (daysDiff > 0 && daysDiff <= 3) {
                    showNotification(
                        'Upcoming Exam!',
                        `${exam.subject} exam in ${Math.ceil(daysDiff)} days`,
                        'danger',
                        10000
                    );
                    hasUpcomingItems = true;
                }
            });
            
            // Check classes for today
            const today = now.toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();
            
            appData.classes.forEach(cls => {
                if (cls.day === today) {
                    const classTime = new Date();
                    const [hours, minutes] = cls.time.split(':');
                    classTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                    
                    const timeDiff = classTime - now;
                    const minutesDiff = timeDiff / (1000 * 60);
                    
                    if (minutesDiff > 0 && minutesDiff <= 30) {
                        showNotification(
                            'Class Starting Soon!',
                            `${cls.name} starts in ${Math.ceil(minutesDiff)} minutes at ${cls.location}`,
                            'info',
                            6000
                        );
                        hasUpcomingItems = true;
                    }
                }
            });

            // Check for low balance
            const totalPocketMoney = appData.pocketMoney.reduce((sum, item) => sum + item.amount, 0);
            const totalExpenses = appData.expenses.reduce((sum, item) => sum + item.amount, 0);
            const currentBalance = totalPocketMoney - totalExpenses;
            
            if (currentBalance < 500 && currentBalance > 0) {
                showNotification(
                    'Low Balance Alert!',
                    `Your current balance is Rs. ${currentBalance.toFixed(2)}. Consider adding more pocket money.`,
                    'warning',
                    7000
                );
            } else if (currentBalance <= 0) {
                showNotification(
                    'Negative Balance!',
                    `Your balance is Rs. ${currentBalance.toFixed(2)}. You need to add pocket money.`,
                    'danger',
                    8000
                );
            }

            // Check for overdue loans
            appData.loans.forEach(loan => {
                const returnDate = new Date(loan.returnDate);
                if (returnDate < now && loan.type === 'given') {
                    showNotification(
                        'Overdue Loan!',
                        `${loan.person} owes you Rs. ${loan.amount.toFixed(2)} and it's overdue!`,
                        'danger',
                        9000
                    );
                }
            });

            if (!hasUpcomingItems) {
                // Show a motivational message if no urgent notifications
                const messages = [
                    "You're doing great! Keep managing your finances wisely.",
                    "Stay organized and productive!",
                    "Remember to track all your expenses for better budgeting.",
                    "Your hostel life is under control with Sigma-Ruler!"
                ];
                const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                
                showNotification(
                    'Stay Productive!',
                    randomMessage,
                    'success',
                    5000
                );
            }
        }

        // Load data from localStorage
        function loadData() {
            const savedData = localStorage.getItem('sigmaRulerData');
            if (savedData) {
                appData = JSON.parse(savedData);
            } else {
                initializeSampleData();
            }
            updateAllDisplays();
            
            // Check for notifications every 30 seconds
            setInterval(checkNotifications, 30000);
            // Initial check after 3 seconds
            setTimeout(checkNotifications, 3000);
        }

        // Initialize with sample data
        function initializeSampleData() {
            appData.foodMenu = [
                { id: 1, name: "Chicken Biryani", price: 120, category: "lunch" },
                { id: 2, name: "Chicken Karahi", price: 150, category: "dinner" },
                { id: 3, name: "Chai", price: 20, category: "drinks" },
                { id: 4, name: "Paratha", price: 30, category: "breakfast" },
                { id: 5, name: "Samosa", price: 25, category: "snacks" }
            ];

            appData.classes = [
                { id: 1, name: "Data Structures", day: "monday", time: "09:00", location: "CS-101" },
                { id: 2, name: "Database Systems", day: "tuesday", time: "11:00", location: "CS-102" },
                { id: 3, name: "Web Development", day: "wednesday", time: "14:00", location: "Lab-3" }
            ];

            // Add sample assignment with near deadline for testing notifications
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            appData.assignments = [
                { 
                    id: 1, 
                    title: "Web Development Project", 
                    subject: "Computer Science", 
                    deadline: tomorrow.toISOString().slice(0, 16),
                    topic: "Build a responsive website using HTML, CSS, and JavaScript"
                }
            ];

            saveData();
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('sigmaRulerData', JSON.stringify(appData));
        }

        // Navigation between modules
        document.querySelectorAll('.dashboard-card').forEach(card => {
            card.addEventListener('click', function() {
                const module = this.getAttribute('data-module');
                showModule(module);
            });
        });

        document.querySelectorAll('.back-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                showDashboard();
            });
        });

        function showDashboard() {
            document.getElementById('main-dashboard').style.display = 'grid';
            document.querySelectorAll('.module').forEach(module => {
                module.classList.remove('active');
            });
        }

        function showModule(moduleName) {
            document.getElementById('main-dashboard').style.display = 'none';
            document.querySelectorAll('.module').forEach(module => {
                module.classList.remove('active');
            });
            document.getElementById(`${moduleName}-module`).classList.add('active');
        }

        // Tab navigation
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabContainer = this.closest('.module').querySelector('.nav-tabs');
                const tabContents = this.closest('.module').querySelectorAll('.tab-content');
                
                // Update active tab button
                tabContainer.querySelectorAll('.tab-btn').forEach(tab => {
                    tab.classList.remove('active');
                });
                this.classList.add('active');
                
                // Show active tab content
                const tabId = this.getAttribute('data-tab');
                tabContents.forEach(content => {
                    content.classList.add('hidden');
                });
                document.getElementById(`${tabId}-tab`).classList.remove('hidden');
            });
        });

        // Edit modal management
        document.getElementById('closeEditModal').addEventListener('click', () => {
            document.getElementById('editModal').classList.remove('active');
        });

        // Function to open edit modal
        function openEditModal(item, type) {
            currentEditItem = item;
            currentEditType = type;
            
            const editModal = document.getElementById('editModal');
            const editForm = document.getElementById('editForm');
            const editModalTitle = document.getElementById('editModalTitle');
            
            // Set modal title
            editModalTitle.textContent = `Edit ${type.charAt(0).toUpperCase() + type.slice(1)}`;
            
            // Clear previous form
            editForm.innerHTML = '';
            
            // Create form based on type
            let formHTML = '';
            
            switch(type) {
                case 'pocket':
                    formHTML = `
                        <div class="form-group">
                            <label for="edit-pocket-amount">Amount (Rs.)</label>
                            <input type="number" id="edit-pocket-amount" value="${item.amount}" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-pocket-date">Date Received</label>
                            <input type="date" id="edit-pocket-date" value="${item.date}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-pocket-source">Source</label>
                            <input type="text" id="edit-pocket-source" value="${item.source}" required>
                        </div>
                    `;
                    break;
                    
                case 'expense':
                    formHTML = `
                        <div class="form-group">
                            <label for="edit-expense-amount">Amount (Rs.)</label>
                            <input type="number" id="edit-expense-amount" value="${item.amount}" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-expense-date">Date</label>
                            <input type="date" id="edit-expense-date" value="${item.date}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-expense-category">Category</label>
                            <select id="edit-expense-category" required>
                                <option value="food" ${item.category === 'food' ? 'selected' : ''}>Food</option>
                                <option value="transport" ${item.category === 'transport' ? 'selected' : ''}>Transport</option>
                                <option value="entertainment" ${item.category === 'entertainment' ? 'selected' : ''}>Entertainment</option>
                                <option value="bills" ${item.category === 'bills' ? 'selected' : ''}>Bills</option>
                                <option value="other" ${item.category === 'other' ? 'selected' : ''}>Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-expense-description">Description</label>
                            <input type="text" id="edit-expense-description" value="${item.description}" required>
                        </div>
                    `;
                    break;
                    
                case 'loan':
                    formHTML = `
                        <div class="form-group">
                            <label for="edit-loan-amount">Amount (Rs.)</label>
                            <input type="number" id="edit-loan-amount" value="${item.amount}" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-loan-type">Type</label>
                            <select id="edit-loan-type" required>
                                <option value="given" ${item.type === 'given' ? 'selected' : ''}>Given to Someone</option>
                                <option value="taken" ${item.type === 'taken' ? 'selected' : ''}>Taken from Someone</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-loan-person">Person</label>
                            <input type="text" id="edit-loan-person" value="${item.person}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-loan-date">Date</label>
                            <input type="date" id="edit-loan-date" value="${item.date}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-return-date">Return Date</label>
                            <input type="date" id="edit-return-date" value="${item.returnDate}" required>
                        </div>
                    `;
                    break;
                    
                case 'food':
                    formHTML = `
                        <div class="form-group">
                            <label for="edit-food-name">Food Name</label>
                            <input type="text" id="edit-food-name" value="${item.name}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-food-price">Price (Rs.)</label>
                            <input type="number" id="edit-food-price" value="${item.price}" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-food-category">Category</label>
                            <select id="edit-food-category" required>
                                <option value="breakfast" ${item.category === 'breakfast' ? 'selected' : ''}>Breakfast</option>
                                <option value="lunch" ${item.category === 'lunch' ? 'selected' : ''}>Lunch</option>
                                <option value="dinner" ${item.category === 'dinner' ? 'selected' : ''}>Dinner</option>
                                <option value="snacks" ${item.category === 'snacks' ? 'selected' : ''}>Snacks</option>
                                <option value="drinks" ${item.category === 'drinks' ? 'selected' : ''}>Drinks</option>
                            </select>
                        </div>
                    `;
                    break;
                    
                case 'class':
                    formHTML = `
                        <div class="form-group">
                            <label for="edit-class-name">Class Name</label>
                            <input type="text" id="edit-class-name" value="${item.name}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-class-day">Day</label>
                            <select id="edit-class-day" required>
                                <option value="monday" ${item.day === 'monday' ? 'selected' : ''}>Monday</option>
                                <option value="tuesday" ${item.day === 'tuesday' ? 'selected' : ''}>Tuesday</option>
                                <option value="wednesday" ${item.day === 'wednesday' ? 'selected' : ''}>Wednesday</option>
                                <option value="thursday" ${item.day === 'thursday' ? 'selected' : ''}>Thursday</option>
                                <option value="friday" ${item.day === 'friday' ? 'selected' : ''}>Friday</option>
                                <option value="saturday" ${item.day === 'saturday' ? 'selected' : ''}>Saturday</option>
                                <option value="sunday" ${item.day === 'sunday' ? 'selected' : ''}>Sunday</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-class-time">Time</label>
                            <input type="time" id="edit-class-time" value="${item.time}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-class-location">Location</label>
                            <input type="text" id="edit-class-location" value="${item.location}" required>
                        </div>
                    `;
                    break;
                    
                case 'assignment':
                    formHTML = `
                        <div class="form-group">
                            <label for="edit-assignment-title">Title</label>
                            <input type="text" id="edit-assignment-title" value="${item.title}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-assignment-subject">Subject</label>
                            <input type="text" id="edit-assignment-subject" value="${item.subject}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-assignment-deadline">Deadline</label>
                            <input type="datetime-local" id="edit-assignment-deadline" value="${item.deadline}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-assignment-topic">Topic/Description</label>
                            <textarea id="edit-assignment-topic" rows="3" required>${item.topic}</textarea>
                        </div>
                    `;
                    break;
                    
                case 'exam':
                    formHTML = `
                        <div class="form-group">
                            <label for="edit-exam-subject">Subject</label>
                            <input type="text" id="edit-exam-subject" value="${item.subject}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-exam-date">Date & Time</label>
                            <input type="datetime-local" id="edit-exam-date" value="${item.date}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-exam-location">Location</label>
                            <input type="text" id="edit-exam-location" value="${item.location}" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-exam-topics">Topics to Study</label>
                            <textarea id="edit-exam-topics" rows="3" required>${item.topics}</textarea>
                        </div>
                    `;
                    break;
            }
            
            formHTML += `<button type="submit" class="btn" style="margin-top: 20px;">Save Changes</button>`;
            editForm.innerHTML = formHTML;
            
            // Show modal
            editModal.classList.add('active');
        }

        // Edit form submission
        document.getElementById('editForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!currentEditItem || !currentEditType) return;
            
            // Update item based on type
            switch(currentEditType) {
                case 'pocket':
                    currentEditItem.amount = parseFloat(document.getElementById('edit-pocket-amount').value);
                    currentEditItem.date = document.getElementById('edit-pocket-date').value;
                    currentEditItem.source = document.getElementById('edit-pocket-source').value;
                    break;
                    
                case 'expense':
                    currentEditItem.amount = parseFloat(document.getElementById('edit-expense-amount').value);
                    currentEditItem.date = document.getElementById('edit-expense-date').value;
                    currentEditItem.category = document.getElementById('edit-expense-category').value;
                    currentEditItem.description = document.getElementById('edit-expense-description').value;
                    break;
                    
                case 'loan':
                    currentEditItem.amount = parseFloat(document.getElementById('edit-loan-amount').value);
                    currentEditItem.type = document.getElementById('edit-loan-type').value;
                    currentEditItem.person = document.getElementById('edit-loan-person').value;
                    currentEditItem.date = document.getElementById('edit-loan-date').value;
                    currentEditItem.returnDate = document.getElementById('edit-return-date').value;
                    break;
                    
                case 'food':
                    currentEditItem.name = document.getElementById('edit-food-name').value;
                    currentEditItem.price = parseFloat(document.getElementById('edit-food-price').value);
                    currentEditItem.category = document.getElementById('edit-food-category').value;
                    break;
                    
                case 'class':
                    currentEditItem.name = document.getElementById('edit-class-name').value;
                    currentEditItem.day = document.getElementById('edit-class-day').value;
                    currentEditItem.time = document.getElementById('edit-class-time').value;
                    currentEditItem.location = document.getElementById('edit-class-location').value;
                    break;
                    
                case 'assignment':
                    currentEditItem.title = document.getElementById('edit-assignment-title').value;
                    currentEditItem.subject = document.getElementById('edit-assignment-subject').value;
                    currentEditItem.deadline = document.getElementById('edit-assignment-deadline').value;
                    currentEditItem.topic = document.getElementById('edit-assignment-topic').value;
                    break;
                    
                case 'exam':
                    currentEditItem.subject = document.getElementById('edit-exam-subject').value;
                    currentEditItem.date = document.getElementById('edit-exam-date').value;
                    currentEditItem.location = document.getElementById('edit-exam-location').value;
                    currentEditItem.topics = document.getElementById('edit-exam-topics').value;
                    break;
            }
            
            saveData();
            updateAllDisplays();
            document.getElementById('editModal').classList.remove('active');
            showNotification('Item Updated', 'The item has been updated successfully', 'success');
        });

        // Form submission handlers
        document.getElementById('pocket-money-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const pocketMoney = {
                id: Date.now(),
                amount: parseFloat(document.getElementById('pocket-amount').value),
                date: document.getElementById('pocket-date').value,
                source: document.getElementById('pocket-source').value
            };
            
            appData.pocketMoney.push(pocketMoney);
            saveData();
            updateFinanceDisplays();
            this.reset();
            showNotification('Success', 'Pocket money added successfully!', 'success');
        });

        document.getElementById('expense-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const expense = {
                id: Date.now(),
                amount: parseFloat(document.getElementById('expense-amount').value),
                date: document.getElementById('expense-date').value,
                category: document.getElementById('expense-category').value,
                description: document.getElementById('expense-description').value
            };
            
            appData.expenses.push(expense);
            saveData();
            updateFinanceDisplays();
            this.reset();
            showNotification('Success', 'Expense added successfully!', 'success');
        });

        document.getElementById('loan-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const loan = {
                id: Date.now(),
                amount: parseFloat(document.getElementById('loan-amount').value),
                type: document.getElementById('loan-type').value,
                person: document.getElementById('loan-person').value,
                date: document.getElementById('loan-date').value,
                returnDate: document.getElementById('return-date').value
            };
            
            appData.loans.push(loan);
            saveData();
            updateFinanceDisplays();
            this.reset();
            showNotification('Success', 'Loan added successfully!', 'success');
        });

        document.getElementById('food-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const foodItem = {
                id: Date.now(),
                name: document.getElementById('food-name').value,
                price: parseFloat(document.getElementById('food-price').value),
                category: document.getElementById('food-category').value
            };
            
            appData.foodMenu.push(foodItem);
            saveData();
            updateFoodDisplay();
            this.reset();
            showNotification('Success', 'Food item added successfully!', 'success');
        });

        document.getElementById('class-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const classItem = {
                id: Date.now(),
                name: document.getElementById('class-name').value,
                day: document.getElementById('class-day').value,
                time: document.getElementById('class-time').value,
                location: document.getElementById('class-location').value
            };
            
            appData.classes.push(classItem);
            saveData();
            updateStudyDisplays();
            this.reset();
            showNotification('Success', 'Class added successfully!', 'success');
        });

        document.getElementById('assignment-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const assignment = {
                id: Date.now(),
                title: document.getElementById('assignment-title').value,
                subject: document.getElementById('assignment-subject').value,
                deadline: document.getElementById('assignment-deadline').value,
                topic: document.getElementById('assignment-topic').value
            };
            
            appData.assignments.push(assignment);
            saveData();
            updateStudyDisplays();
            this.reset();
            showNotification('Success', 'Assignment added successfully!', 'success');
        });

        document.getElementById('exam-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const exam = {
                id: Date.now(),
                subject: document.getElementById('exam-subject').value,
                date: document.getElementById('exam-date').value,
                location: document.getElementById('exam-location').value,
                topics: document.getElementById('exam-topics').value
            };
            
            appData.exams.push(exam);
            saveData();
            updateStudyDisplays();
            this.reset();
            showNotification('Success', 'Exam added successfully!', 'success');
        });

        // Update all displays
        function updateAllDisplays() {
            updateFinanceDisplays();
            updateFoodDisplay();
            updateStudyDisplays();
        }

        // Helper function to get item by ID and type
        function getItemById(id, type) {
            switch(type) {
                case 'pocket': return appData.pocketMoney.find(item => item.id === id);
                case 'expense': return appData.expenses.find(item => item.id === id);
                case 'loan': return appData.loans.find(item => item.id === id);
                case 'food': return appData.foodMenu.find(item => item.id === id);
                case 'class': return appData.classes.find(item => item.id === id);
                case 'assignment': return appData.assignments.find(item => item.id === id);
                case 'exam': return appData.exams.find(item => item.id === id);
                default: return null;
            }
        }

        // Update finance displays with tables
        function updateFinanceDisplays() {
            // Update pocket money table
            const pocketMoneyTable = document.getElementById('pocket-money-table');
            pocketMoneyTable.innerHTML = '';
            
            appData.pocketMoney.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(item.date).toLocaleDateString()}</td>
                    <td>${item.source}</td>
                    <td class="amount-positive">Rs. ${item.amount.toFixed(2)}</td>
                    <td class="table-actions">
                        <button class="action-btn edit-btn" data-id="${item.id}" data-type="pocket">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-btn" data-id="${item.id}" data-type="pocket">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                pocketMoneyTable.appendChild(row);
            });

            // Update expenses table
            const expensesTable = document.getElementById('expenses-table');
            expensesTable.innerHTML = '';
            
            appData.expenses.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(item.date).toLocaleDateString()}</td>
                    <td>${item.description}</td>
                    <td>${item.category}</td>
                    <td class="amount-negative">Rs. ${item.amount.toFixed(2)}</td>
                    <td class="table-actions">
                        <button class="action-btn edit-btn" data-id="${item.id}" data-type="expense">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-btn" data-id="${item.id}" data-type="expense">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                expensesTable.appendChild(row);
            });

            // Update loans table
            const loansTable = document.getElementById('loans-table');
            loansTable.innerHTML = '';
            
            appData.loans.forEach(item => {
                const today = new Date();
                const returnDate = new Date(item.returnDate);
                const isOverdue = returnDate < today;
                const status = isOverdue ? '<span class="badge badge-danger">Overdue</span>' : '<span class="badge badge-success">Active</span>';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(item.date).toLocaleDateString()}</td>
                    <td>${item.person}</td>
                    <td>${item.type === 'given' ? 'Given' : 'Taken'}</td>
                    <td class="${item.type === 'given' ? 'amount-negative' : 'amount-positive'}">Rs. ${item.amount.toFixed(2)}</td>
                    <td>${new Date(item.returnDate).toLocaleDateString()}</td>
                    <td>${status}</td>
                    <td class="table-actions">
                        <button class="action-btn edit-btn" data-id="${item.id}" data-type="loan">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-btn" data-id="${item.id}" data-type="loan">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                loansTable.appendChild(row);
            });

            // Update summary
            const totalPocketMoney = appData.pocketMoney.reduce((sum, item) => sum + item.amount, 0);
            const totalExpenses = appData.expenses.reduce((sum, item) => sum + item.amount, 0);
            const currentBalance = totalPocketMoney - totalExpenses;
            const activeLoans = appData.loans.length;

            document.getElementById('total-pocket-money').textContent = `Rs. ${totalPocketMoney.toFixed(2)}`;
            document.getElementById('total-expenses').textContent = `Rs. ${totalExpenses.toFixed(2)}`;
            document.getElementById('current-balance').textContent = `Rs. ${currentBalance.toFixed(2)}`;
            document.getElementById('active-loans').textContent = activeLoans;

            // Add event listeners for edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const type = this.getAttribute('data-type');
                    const item = getItemById(id, type);
                    if (item) openEditModal(item, type);
                });
            });

            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const type = this.getAttribute('data-type');
                    deleteItem(id, type);
                });
            });
        }

        // Update food display with table
        function updateFoodDisplay() {
            const foodMenuTable = document.getElementById('food-menu-table');
            foodMenuTable.innerHTML = '';
            
            appData.foodMenu.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.category.charAt(0).toUpperCase() + item.category.slice(1)}</td>
                    <td class="amount-positive">Rs. ${item.price.toFixed(2)}</td>
                    <td class="table-actions">
                        <button class="action-btn edit-btn" data-id="${item.id}" data-type="food">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-btn" data-id="${item.id}" data-type="food">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                foodMenuTable.appendChild(row);
            });
        }

        // Update study displays with tables
        function updateStudyDisplays() {
            // Update classes schedule
            const scheduleGrid = document.querySelector('#classes-tab .schedule-grid');
            scheduleGrid.innerHTML = '';
            
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            
            days.forEach(day => {
                const dayClasses = appData.classes.filter(cls => cls.day === day);
                if (dayClasses.length > 0) {
                    const daySection = document.createElement('div');
                    daySection.className = 'day-schedule';
                    daySection.innerHTML = `
                        <div class="day-header">
                            ${day.charAt(0).toUpperCase() + day.slice(1)}
                        </div>
                    `;
                    
                    dayClasses.forEach(cls => {
                        const classItem = document.createElement('div');
                        classItem.className = 'schedule-item';
                        classItem.innerHTML = `
                            <div>
                                <h4>${cls.name}</h4>
                                <p>${cls.location}</p>
                            </div>
                            <div class="schedule-time">${cls.time}</div>
                            <div class="table-actions">
                                <button class="action-btn edit-btn" data-id="${cls.id}" data-type="class">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn delete-btn" data-id="${cls.id}" data-type="class">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `;
                        daySection.appendChild(classItem);
                    });
                    
                    scheduleGrid.appendChild(daySection);
                }
            });

            // Update assignments table
            const assignmentsTable = document.getElementById('assignments-table');
            assignmentsTable.innerHTML = '';
            
            appData.assignments.forEach(item => {
                const deadline = new Date(item.deadline);
                const now = new Date();
                const timeDiff = deadline - now;
                const daysDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));
                
                let status = '<span class="badge badge-success">Upcoming</span>';
                if (daysDiff < 0) {
                    status = '<span class="badge badge-danger">Overdue</span>';
                } else if (daysDiff <= 3) {
                    status = '<span class="badge badge-warning">Due Soon</span>';
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.title}</td>
                    <td>${item.subject}</td>
                    <td>${deadline.toLocaleString()}</td>
                    <td>${status}</td>
                    <td class="table-actions">
                        <button class="action-btn edit-btn" data-id="${item.id}" data-type="assignment">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-btn" data-id="${item.id}" data-type="assignment">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                assignmentsTable.appendChild(row);
            });

            // Update exams table
            const examsTable = document.getElementById('exams-table');
            examsTable.innerHTML = '';
            
            appData.exams.forEach(item => {
                const examDate = new Date(item.date);
                const now = new Date();
                const timeDiff = examDate - now;
                const daysDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));
                
                let status = '<span class="badge badge-success">Upcoming</span>';
                if (daysDiff < 0) {
                    status = '<span class="badge badge-danger">Completed</span>';
                } else if (daysDiff <= 7) {
                    status = '<span class="badge badge-warning">Soon</span>';
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.subject}</td>
                    <td>${examDate.toLocaleString()}</td>
                    <td>${item.location}</td>
                    <td>${status}</td>
                    <td class="table-actions">
                        <button class="action-btn edit-btn" data-id="${item.id}" data-type="exam">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-btn" data-id="${item.id}" data-type="exam">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                examsTable.appendChild(row);
            });

            // Add event listeners for edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const type = this.getAttribute('data-type');
                    const item = getItemById(id, type);
                    if (item) openEditModal(item, type);
                });
            });

            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const type = this.getAttribute('data-type');
                    deleteItem(id, type);
                });
            });
        }

        // Universal delete function
        function deleteItem(id, type) {
            if (confirm('Are you sure you want to delete this item?')) {
                switch(type) {
                    case 'pocket':
                        appData.pocketMoney = appData.pocketMoney.filter(item => item.id !== id);
                        break;
                    case 'expense':
                        appData.expenses = appData.expenses.filter(item => item.id !== id);
                        break;
                    case 'loan':
                        appData.loans = appData.loans.filter(item => item.id !== id);
                        break;
                    case 'food':
                        appData.foodMenu = appData.foodMenu.filter(item => item.id !== id);
                        break;
                    case 'assignment':
                        appData.assignments = appData.assignments.filter(item => item.id !== id);
                        break;
                    case 'exam':
                        appData.exams = appData.exams.filter(item => item.id !== id);
                        break;
                    case 'class':
                        appData.classes = appData.classes.filter(item => item.id !== id);
                        break;
                }
                saveData();
                updateAllDisplays();
                showNotification('Deleted', 'Item deleted successfully', 'success');
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            
            // Add global event listeners for edit and delete buttons
            document.addEventListener('click', function(e) {
                if (e.target.closest('.edit-btn')) {
                    const btn = e.target.closest('.edit-btn');
                    const id = parseInt(btn.getAttribute('data-id'));
                    const type = btn.getAttribute('data-type');
                    const item = getItemById(id, type);
                    if (item) openEditModal(item, type);
                }
                
                if (e.target.closest('.delete-btn')) {
                    const btn = e.target.closest('.delete-btn');
                    const id = parseInt(btn.getAttribute('data-id'));
                    const type = btn.getAttribute('data-type');
                    deleteItem(id, type);
                }
            });
            
            // Request notification permission
            if ('Notification' in window) {
                Notification.requestPermission();
            }
        });
    </script>
</body>
</html>
